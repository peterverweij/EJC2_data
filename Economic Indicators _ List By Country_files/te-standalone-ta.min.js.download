function extractor_multi(e) { if (!e) return ""; var t = e.split(/\s/); return t && t[0] ? [t.slice(Math.max(0, t.length - 5), t.length).join(" "), t.slice(Math.max(0, t.length - 4), t.length).join(" "), t.slice(Math.max(0, t.length - 3), t.length).join(" "), t.slice(Math.max(0, t.length - 2), t.length).join(" "), t.slice(Math.max(0, t.length - 1), t.length).join(" ")] : "" } function capitaliseFirstLetter(e) { return ((e = (e + "").toLowerCase()) + "").replace(/^([a-z])|\s+([a-z])/g, function (e) { return e.toUpperCase() }).replace(/Gdp/g, "GDP").replace(/Ppp/g, "PPP").replace(/cpi/gi, "CPI").replace(/S\&t/g, "S&T").replace(/S\&p/g, "S&P") } function searchQueryEncode(e) { return whiteSpaceKiller(e.replace(/\%/g, "percent ").replace(/\,|\\|_/g, " ")).trim().replace(/\s|\t/g, "-").replace(/\:|\(|\)/g, "").toLowerCase() } function whiteSpaceKiller(e) { return (e = e.replace(/\s\s/g, " ")).match(/\s\s/) ? whiteSpaceKiller(e) : e } !function (e, t) { "use strict"; "undefined" != typeof module && module.exports ? module.exports = t(require("jquery")(e)) : "function" == typeof define && define.amd ? define("bootstrap3-typeahead", ["jquery"], function (e) { return t(e) }) : t(e.jQuery) }(this, function (e) { "use strict"; if (void 0 === t) var t = {}; t.default = ['<div class="ieacac-tabs hidden-xs">', '<ul class="iecac-menu-tabs">', "</ul>", "</div>"]; var i = function (i, s) { if (this.$element = e(i), this.options = e.extend({}, e.fn.iec_typeahead.defaults, s), this.matcher = this.options.matcher || this.matcher, this.wrapper = this.options.wrapper || [], this.table_chart_button = this.options.table_chart_button || !1, this.goDirectly = this.options.goDirectly || !1, this.lang = "string" == typeof window.iec_language ? window.iec_language : "en", this.sorter = this.options.sorter || this.sorter, this.allow_more = this.options.allow_more || !1, this.go_for_context = this.options.go_for_context || this.options.goForContext || !1, this.in_context_length = this.options.in_context_length || this.options.inContextLength || 0, this.in_context_stack = [], this.rendered = 0, this.select = this.options.select || this.select, this.allow_facilitator_more = this.options.allow_facilitator_more || this.options.allowNavigator || !1, this.on_facilitator_more_click = this.options.on_facilitator_more_click || this.options.onNavigatorMoreClick || !1, this.autoSelect = "boolean" != typeof this.options.autoSelect || this.options.autoSelect, this.expandable = "boolean" == typeof this.options.expandable && this.options.expandable, this.highlighter = this.options.highlighter || this.highlighter, this.render = this.options.render || this.render, this.updater = this.options.updater || this.updater, this.source = this.options.source, this.delay = "number" == typeof this.options.delay ? this.options.delay : 100, this.forceRenderToTextBox = void 0 === this.options.forceRenderToTextBox || this.options.forceRenderToTextBox, this.selectionHandler = void 0 !== this.options.selectionHandler && this.options.selectionHandler, this.$menu = e(this.options.menu), this.options.setClasses && this.options.setClasses.ul) { var o = this.options.setClasses.ul.split(" "); for (var n in o) this.$menu.addClass(o[n]) } if (this.options.setStyles && this.options.setStyles.ul) for (var a in this.options.setStyles.ul) this.options.setStyles.ul[a].p && (console.log("setting style", this.options.setStyles.ul[a]), this.$menu.style(this.options.setStyles.ul[a].p, this.options.setStyles.ul[a].v, this.options.setStyles.ul[a].i)); this.shown = !1, this.tabs = [], this.stance = 0, this.req_num = 0, this.listen(), this.showHintOnFocus = "boolean" == typeof this.options.showHintOnFocus && this.options.showHintOnFocus, this.afterSelect = this.options.afterSelect || this.afterSelect, this.appendMenuTo = this.options.appendMenuTo || !1, this.originalQuery = !1, this.searching_for_something = !1, this.renderAnimation = this.options.renderAnimation || !1; var r = {}; void 0 !== t ? r = t : void 0 !== s.typeahead_little_helper && (r = this.options.typeahead_little_helper), this.typeahead_little_helper = r, void 0 === this.options.typeahead_little_helper && (this.options.typeahead_little_helper = r), r[this.wrapper] ? this.classname = e(r[this.wrapper][0])[0].className || "none" : this.classname = "none", this.own_special_class = "ieconomics-" + Math.round(1e6 * Math.random()) + "-logic", this.$element.data("ieconomics", this.own_special_class), this.$element.addClass(this.own_special_class) }; i.prototype = { constructor: i, afterSelect: function (t, i) { if (t && "go" == t) { console.log("trigger:", t), this.renderAnimation && this.renderAnimation(); var s = (e("#searchu").val() || e("#searchd").val()).trim().toLowerCase(); window.searchQueryEncode && (s = searchQueryEncode(s)), window.location.href = "http://" + window.location.host + "/" + s } }, select: function (t) { var i = this, s = i.$menu.find(".active").data("value"), o = !0; s || (s = i.$element.val(), o = !1); var n = { raw: i.$menu.find(".active").data("raw") || s, value: s, isListed: o, type: i.$menu.find(".active").data("type") }; if (this.selectionHandler) return this.selectionHandler("https://tradingeconomics.com" + s, n, e("#" + this.options.searchBoxId).val()); if ("go_more_results" != s) { if (i.autoSelect || s) { if ("go_facilitator_modal" == s) return this.hide(), event.preventDefault(), event.stopPropagation(), i.mouse_ignore = !0, i.focusout(), void (i.on_facilitator_more_click && i.on_facilitator_more_click()); i.goDirectly ? (this.renderAnimation && this.renderAnimation(), this.hide(), e("#searchButton").attr("style", "background-image: url('/cdn/ie/img/roundload.gif')!important;background-color: #fff;"), window.location.href = "http://" + window.location.host + "/" + ("en" == i.lang ? "" : i.lang + "/") + searchQueryEncode(s)) : (i.$element.val(i.updater(s)).change(), i.table_chart_button && t ? i.afterSelect(t, n) : i.afterSelect(null, n)) } else i.table_chart_button && t ? i.afterSelect(t, n) : i.afterSelect("go", n); return this.hide(), this.mouse_ignore = !0, "" } window.location.href = "https://tradingeconomics.com" + ("en" == i.lang ? "" : i.lang + "/") + "more/" + (e("#searchu").val() || e("#searchd").val()).trim().toLowerCase().replace(/\s/, "-") }, updater: function (e) { this.query; return e }, setSource: function (e) { this.source = e }, show: function () { var t, i = e.extend({}, this.$element.position(), { height: this.$element[0].offsetHeight }); t = "function" == typeof this.options.scrollHeight ? this.options.scrollHeight.call() : this.options.scrollHeight; var s = i.top + i.height + t, o = i.left; return this.options.align && "left" == this.options.align && (console.log("fix left", this.$menu.width()), o = i.left + this.$element.width() - (0 != this.$menu.width() ? this.$menu.width() : 556)), this.appendMenuTo ? this.appendMenuTo.append(this.$menu.css({ top: s, left: o, display: "table" })) : this.forceRenderToTextBox ? this.$menu.insertAfter(this.$element).css({ top: s, left: o, display: "table" }) : this.$menu.show(), this.shown = !0, this }, hide: function () { return this.shown && (this.$menu.hide(), this.shown = !1), this }, lookup: function (t) { var i; if (this.originalQuery = !1, this.have_news = !0, this.query = void 0 !== t && null !== t ? t : this.$element.val() || "", this.query.length > this.options.minLength) { this.searching_for_something = setTimeout(function () { }, 1e3) } if (this.query.length < this.options.minLength && !this.showHintOnFocus) return this.shown ? this.hide() : this; var s = e.proxy(function () { var t = "?"; this.options.searchBoxId && "thisIstheSearchBoxIdTag" == this.options.searchBoxId && (t = "&"), (i = e.isFunction(this.source) ? this.source(this.query + t + "stance=" + ++this.req_num, e.proxy(this.process, this)) : this.source) && this.process(i) }, this); clearTimeout(this.lookupWorker), this.lookupWorker = setTimeout(s, this.delay) }, process: function (t) { this.have_news = !1, clearTimeout(this.searching_for_something); var i = this; if (t[0]) { if (t[0].stance) if (!(t[0].stance == i.req_num || "searching" == t[0].stance)) return; (t[0].total || 0 === t[0].total) && (i.setBadges(t[0]), t = t.slice(1, t.length + 1)) } return t = e.grep(t, function (e) { return i.matcher(e.name) }), (t = this.sorter(t)).length ? "all" == this.options.items ? this.render(t).show() : this.focused ? this.render(t).show() : void 0 : this.shown ? this.hide() : this }, setBadges: function (i) { var s = this; if (s.tabs = [], 0 == s.tabs.length) { var o = t[this.wrapper]; for (var n in o) { var a = (e(o[n]).find("span").attr("class") || "").replace("iec-menu-tabs-nresults numresults-", ""); if (!(a.length < 1)) if (a != i.tab) s.tabs.push({ l: n, tab: a }); else { if ("all" == a && 0 === i.total) return console.info("zero"), s.focused = !1, s.hide(); s.populate(n, a, i.total) } } s.stance++, s.fetchAndPopulate(s.stance) } }, fetchAndPopulate: function (e) { var t = this; t.stance > e || t.tabs[0] && jQuery.getJSON("http://" + iec_api + "/src/iecac/" + t.query + "?tab=" + t.tabs[0].tab + " &onlystats=true", function () { }).done(function (i) { t.populate(t.tabs[0].l, t.tabs[0].tab, i[0].total), t.stance > e || (t.tabs = t.tabs.slice(1, t.tabs.length), t.fetchAndPopulate(e)) }) }, populate: function (i, s, o) { (o || 0 === o) && (t[this.wrapper][i] = e(t[this.wrapper][i]).find("span").text("(" + o + ")").parent().prop("outerHTML"), e(".numresults-" + s).text("(" + o + ")")) }, matcher: function (e) { return e ? "no results" == e ? -1 : "searching" == e ? -1 : ~e.toLowerCase().indexOf(this.query.toLowerCase()) > -1 ? -1 : ~e.toLowerCase().indexOf(this.query.toLowerCase()) : -1 }, sorter: function (e) { return e }, highlighter: function (e) { var t = extractor_multi(this.query), i = 0; return e ? (e.match(new RegExp("(" + (t[0] || "").trim() + ")", "ig")) || (e.match(new RegExp("(" + t[1] + ")", "ig")) ? i = 1 : e.match(new RegExp("(" + t[2] + ")", "ig")) ? i = 2 : e.match(new RegExp("(" + t[3] + ")", "ig")) ? i = 3 : e.match(new RegExp("(" + t[4] + ")", "ig")) && (i = 4)), e.replace(new RegExp("(" + t[i] + ")", "ig"), function (e, t) { return "<strong>" + t + "</strong>" })) : "" }, render: function (t) { var i = t; t[0] && void 0 !== t[0].page && (i = t[1]); var s = this; t.length; if (t = e(i).map(function (t, i) { t || (s.in_context_stack = [], s.rendered = 0); var o = s.options.items; if (s.allow_facilitator_more && o > 1 && (o -= 1), !(s.rendered > o)) { i.full_name = i.pretty_name || i.full_name || i.name, i.name = i.pretty_name || i.name, i.the_url = i.url || i.the_url || i.value, i.value = i.the_url, (t = e(s.options.item)).addClass("list-group-item"), t.data("value", (i.value || "").toLowerCase()), t.data("type", (i.type || "").toLowerCase()), t.data("raw", i.value), t.find("a").prop("title", i.full_name || i.name), t.find("a").prop("href", "https://tradingeconomics.com" + i.the_url), t.find("a > .iec-dd-val").html(s.highlighter(i.name.replace(/\-/g, ""))), t.find("a > .iec-dd-symbol").html(i.symbol); var n = !1; return i.url && i.url.indexOf(":") > 0 && ("GOV" != (n = i.url.split(":")[1].toUpperCase()) && "IND" != n && "CUR" != n && "COM" != n || (n = !1)), i.origin = n || i.origin, i.origin ? t.find("a > .iec-dd-origin").html(i.origin.toUpperCase()) : t.find("a > .iec-dd-origin").addClass("iec-dd-origin-empty"), s.rendered++, t[0] } }), this.autoSelect && t.first().addClass("active"), this.options.renderDiv ? this.$menu = e("#" + this.options.renderDiv) : this.$menu.html(this.options.typeahead_little_helper[this.wrapper].join("\n")), this.$menu.empty(), this.$menu.append(t), s.allow_more && t.length > 1) { var o = e('<li data-value="go_more_results" class="list-group-item">'), n = e("#" + this.options.searchBoxId).val().trim().toLowerCase(); this.options.moreUrlFormat && (n = this.options.moreUrlFormat + e("#" + this.options.searchBoxId).val().trim().toLowerCase()), o.append('<a href="https://tradingeconomics.com' + n + '"><span class="iec-dd-symbol hidden-xs hidden-sm hidden-md hidden-lg"></span><span class="iec-dd-val iec-typeadead-more">More</span><span class="iec-dd-origin iec-dd-origin-empty hidden-xs"></span></a>'), this.$menu.append(o) } s.allow_facilitator_more && ((o = e('<li class="more-facilitator-modal" data-value="go_facilitator_modal">')).append('<a href="#" ><span class="iec-dd-symbol hidden-xs hidden-sm hidden-md hidden-lg"></span><span class="iec-dd-val iec-typeadead-more">More</span><span class="iec-dd-origin iec-dd-origin-empty hidden-xs"></span></a>'), this.$menu.append(o)); return this }, next: function (t) { var i = this.$menu.find(".active").removeClass("active").next(); i.length || (i = e(this.$menu.find("li")[0])), i.addClass("active") }, prev: function (t) { var i = this.$menu.find(".active").removeClass("active").prev(); i.length || (i = this.$menu.find("li").last()), "DIV" != e(i[0]).get(0).tagName && i.addClass("active") }, listen: function () { this.$element.on("focus", e.proxy(this.focus, this)).on("blur", e.proxy(this.blur, this)).on("focusout", e.proxy(this.focusout, this)).on("keypress", e.proxy(this.keypress, this)).on("keyup", e.proxy(this.keyup, this)), this.eventSupported("keydown") && this.$element.on("keydown", e.proxy(this.keydown, this)), this.$menu.on("click", e.proxy(this.click, this)).on("mouseenter", "li", e.proxy(this.mouseenter, this)).on("mouseleave", "li", e.proxy(this.mouseleave, this)) }, destroy: function () { this.$element.data("typeahead", null), this.$element.off("focus").off("focusout").off("blur").off("keypress").off("keyup"), this.eventSupported("keydown") && this.$element.off("keydown"), this.$menu.remove() }, eventSupported: function (e) { var t = e in this.$element; return t || (this.$element.setAttribute(e, "return;"), t = "function" == typeof this.$element[e]), t }, move: function (t) { if (this.shown) { switch (t.keyCode) { case 9: case 13: case 27: case 39: t.preventDefault(); break; case 38: if (t.shiftKey) return; if (t.preventDefault(), this.prev(), this.originalQuery || (this.originalQuery = this.$element.val()), "more results" == (i = e(e("." + this.classname).parent().find("> li.active")[0]).find("span.iec-dd-val").text()).toLowerCase() || "more" == i.toLowerCase()) return; "" == i.toLowerCase() && (i = this.originalQuery), this.$element.val(i.replace(/\s\s/g, " ").trim().toLowerCase()); break; case 40: if (t.shiftKey) return; t.preventDefault(); var i; if (this.classname.indexOf(" ") > 1 && (this.classname = this.classname.substr(0, this.classname.indexOf(" "))), this.next(), this.originalQuery || (this.originalQuery = this.$element.val()), "more results" == (i = e(e("." + this.classname).parent().find("> li.active")[0]).find("span.iec-dd-val").text()).toLowerCase() || "more" == i.toLowerCase()) return; "" == i.toLowerCase() && (i = this.originalQuery), this.$element.val(i.replace(/\s\s/g, " ").trim().toLowerCase()) } t.stopPropagation() } }, keydown: function (t) { this.suppressKeyPressRepeat = ~e.inArray(t.keyCode, [40, 38, 9, 13, 27, 39]), this.shown || 40 != t.keyCode ? this.move(t) : this.lookup("") }, keypress: function (e) { this.suppressKeyPressRepeat || this.move(e) }, keyup: function (t) { switch (t.keyCode) { case 40: case 38: case 16: case 17: case 18: break; case 9: case 39: if (!this.shown) return; this.select(); break; case 13: if (console.log("event this?", this.shown, this.autoSelect), !this.shown) { if (!this.autoSelect) { if (this.selectionHandler) { var i = { raw: "https://tradingeconomics.com" + this.$element.val(), value: this.$element.val(), isListed: !1, type: !1 }; return this.selectionHandler("https://tradingeconomics.com" + this.$element.val(), i, e("#" + this.options.searchBoxId).val()) } this.goDirectly || this.afterSelect("go") } return } this.select(), this.goDirectly || this.afterSelect("go"); break; case 27: if (!this.shown) return; this.hide(); break; default: this.lookup() } t.stopPropagation(), t.preventDefault() }, focus: function (e) { if (!this.focused) { if (this.focused = !0, this.went_away) return this.$element.blur(), void (this.went_away = !1); this.show(), (0 === this.options.minLength && !this.$element.val() || this.options.showHintOnFocus) && this.lookup() } }, focusout: function (t) { this.focused = !1, this.mousedover || !this.shown || e("#" + this.options.renderDiv).is(":hover") || this.hide() }, click: function (e) { console.log("CLICKED -> e.target", e.target), e.preventDefault(), e.target.className.toString().indexOf("menu-tabs") > -1 || this.select() }, mouseenter: function (t) { this.mousedover = !0, this.$menu.find(".active").removeClass("active"), e(t.currentTarget).addClass("active") }, mouseleave: function (e) { this.mousedover = !1, this.mouse_ignore ? this.mouse_ignore = !1 : this.focused || (this.$element.focus(), this.focused = !0) } }; var s = e.fn.typeahead; e.fn.iec_typeahead = function (t) { var s = arguments; return this.each(function () { var o = e(this), n = o.data("typeahead"), a = "object" == typeof t && t; n || o.data("typeahead", n = new i(this, a)), "string" == typeof t && (s.length > 1 ? n[t].apply(n, Array.prototype.slice.call(s, 1)) : n[t]()) }) }, e.fn.iec_typeahead.defaults = { source: [], items: 8, menu: '<ul class="typeahead dropdown-menu"></ul>', item: '<li><a href="#"><span class="iec-dd-symbol hidden-xs hidden-sm hidden-md hidden-lg"></span><span class="iec-dd-val"></span><span class="iec-dd-origin hidden-xs"></span></a></li>', minLength: 2, scrollHeight: 0, autoSelect: !0 }, e.fn.iec_typeahead.Constructor = i, e.fn.iec_typeahead.noConflict = function () { return e.fn.typeahead = s, this }, e(document).on("focus.typeahead.data-api", '[data-provide="typeahead"]', function (t) { console.log("sadasd"); var i = e(this); i.data("typeahead") || i.iec_typeahead(i.data()) }) }), function (e) { if (!e.fn.style) { var t = function (e) { return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&") }; !!CSSStyleDeclaration.prototype.getPropertyValue || (CSSStyleDeclaration.prototype.getPropertyValue = function (e) { return this.getAttribute(e) }, CSSStyleDeclaration.prototype.setProperty = function (e, i, s) { if (this.setAttribute(e, i), "" != (s = void 0 !== s ? s : "")) { var o = new RegExp(t(e) + "\\s*:\\s*" + t(i) + "(\\s*;)?", "gmi"); this.cssText = this.cssText.replace(o, e + ": " + i + " !" + s + ";") } }, CSSStyleDeclaration.prototype.removeProperty = function (e) { return this.removeAttribute(e) }, CSSStyleDeclaration.prototype.getPropertyPriority = function (e) { return new RegExp(t(e) + "\\s*:\\s*[^\\s]*\\s*!important(\\s*;)?", "gmi").test(this.cssText) ? "important" : "" }), e.fn.style = function (e, t, i) { if (void 0 === this.get(0)) return this; var s = this.get(0).style; return void 0 !== e ? void 0 !== t ? (i = void 0 !== i ? i : "", s.setProperty(e, t, i), this) : s.getPropertyValue(e) : s } } }(jQuery);